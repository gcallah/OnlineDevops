{% extends "base.html" %}
{% block content %}
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                 <h1>
            Software as Infrastructure
        </h1>

                <figure>
                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/df/Evacuated_Highway_401_Color.jpg/580px-Evacuated_Highway_401_Color.jpg"
                    width="21%">
                    <figcaption>
                    </figcaption>
                </figure>

                <p class="leadquote">
                </p>

                <details>
                    <summary class="sum1">
                        Lesson 1
                    </summary>
                </details>

                <details>
                    <summary class="sum1">
                        Lesson 2
                    </summary>
                </details>

                <details>
                    <summary class="sum1">
                        Lesson 3: Running Docker
                    </summary>

                        <p class="author">
                            by
                            <br />
                            Prashantkumar Patel
                        </p>

                        <p>
                            In this webpage we are going to try and host a
                             simple static website in nginx using docker.
                            I have already talked about what version of
                            docker you should use. If you are using Windows
                            then docker-toolbox otherwise just using
                            docker native should be okay for the Mac and
                            Linux users.
                            This tutorial is written and performed in a MacBook
                            computer. Windows users
                            should not have any problem performing the same steps
                            in Windows, but if you
                            find yourself stuck somewhere please send me a slack
                             message, I will try to help you out.
                        </p>

                        <p>
                            First step is to download and install docker,
                            which I am sure everyone in the class did.
                            If not please visit <a href="http://www.docker.com">
                             http://www.docker.com
                             </a>.
                            You should follow the installation instructions
                             given in the website.
                        </p>

                        <h4>
                            Download the nginx image
                        </h4>

                        <p>
                            Let's run the following command in terminal/quickstart-terminal.
                        </p>

                        <p>
                           <code> docker images </code>
                        </p>
                        <p>
                            This command should give you the list of images
                            that are available in the system. For example
                            in my system it looks something like
                            this. Yours might have a different than what I have.
                        </p>


                        <p>
                        <code>
                            <pre>
            ENG-EJC369-02:$ docker images
            REPOSITORY            TAG                 IMAGE ID            CREATED             SIZE
            gcallah/jenkins_py3   latest              21130e104ca1        4 weeks ago         742MB
            jenkins               latest              cd14cecfdb3a        6 weeks ago         696MB
            gcallah/indra         v7                  ad9670e8b27f        2 months ago        946MB
            python                latest              efb6baa1169f        5 months ago        691MB
            ubuntu                latest              f975c5035748        5 months ago        112MB
            gcallah/emu86         v4                  f6833ae8bf9e        6 months ago        776MB
            gcallah/django        latest              432de70e222d        6 months ago        769MB
            bash                  latest              59507b30b48a        6 months ago        12.2MB
            alpine                latest              3fd9065eaf02        7 months ago        4.15MB
                            </pre>
                        </code>
                        </p>


                        <p>
                            As you can see that I don't have the nginx image
                            install. I will run the following command which will
                            install the nginx image for me.
                        </p>

                        <p>
                        <code>
                            docker pull nginx
                        </code>
                        </p>
                        <p>
                            Now that you have installed the nginx image,
                            just run the docker images command again,
                            in the list you should see ngnix image just like
                            down below:
                        </p>

                        <p>
                        <code>
                            <pre>
            ENG-EJC369-02:$ docker images
            REPOSITORY            TAG                 IMAGE ID            CREATED             SIZE
            nginx                 latest              71c43202b8ac        7 hours ago         109MB
            gcallah/jenkins_py3   latest              21130e104ca1        4 weeks ago         742MB
            jenkins               latest              cd14cecfdb3a        6 weeks ago         696MB
            gcallah/indra         v7                  ad9670e8b27f        2 months ago        946MB
            python                latest              efb6baa1169f        5 months ago        691MB
            ubuntu                latest              f975c5035748        5 months ago        112MB
            gcallah/emu86         v4                  f6833ae8bf9e        6 months ago        776MB
            gcallah/django        latest              432de70e222d        6 months ago        769MB
            bash                  latest              59507b30b48a        6 months ago        12.2MB
            alpine                latest              3fd9065eaf02        7 months ago        4.15MB
                            </pre>
                        </code>
                        </p>

                        <h4>
                            Download website code
                        </h4>

                        <p>
                            Ok now that you have download the nginx image,
                            let's download the static website that you
                            are going to host inside the docker container.
                            We are going to use the algorithms website for
                            professor's other subject. You can find the
                            code for the website to
                            <a href="http://gitub.com/gcallah/algorithms.git">
                            algorithms
                            </a>
                        </p>

                        <p>
                            Please remember the location where you have
                            cloned the repository. I have cloned it in
                            <code> /Users/prashant/school/algorithms</code>
                            you's will be different than this, please note
                            the location. Below is the screenshot of algorithms
                            directory.
                        </p>

                        <h4>
                            Let's make a container
                        </h4>

                        <p>
                            Ok, so we have downloaded the nginx image and
                            the code of the website which we want to host
                            All we need to do is just make a container
                            out of the image. We will put the code of
                            website inside the container so that the
                            webserver which is nginx in our case can
                            read the html files and host it in local
                            server.
                            The command for that is as shown below.
                        </p>
                        <p>
                            <code>
                                docker run --name algo_website -p 127.0.0.1:8080:80
                                -v /Users/prashant/school/algorithms/:/usr/share/nginx/html
                                -d nginx
                            </code>
                        </p>

                        <p>
                            Please don't forget to change the location of
                             algorithms directory in above command.
                             After you run the command open the browser
                             and type http://localhost:8080 and you
                             should be able to see the webpage.
                             Windows user should use the address
                             http://192.168.99.100:8080 instead of localhost.
                        </p>


                        <p class="copyright">
                            &copy; 2018 Prashantkumar Patel
                        </p>
                </details>

                <details>
                    <summary class="sum1">
                        Our Docker Implementation
                    </summary>

                    <p>
                    Each project we work on should have a
                    <code>Dockerfile</code> consisting of instructions
                    on how to build the image for that project, a
                    <code>requirements.txt</code> listing what
                    external modules need to be included in the image,
                    and a line in the project's <code>makefile</code>
                    automating the build of the image.
                    </p>

                    <p>
                        So, in the <code>makefile</code> we want something
                        like:
                    </p>

                    <p>
                    <code>
                        <pre>
                container: $(DOCKER_DIR)/Dockerfile  $(DOCKER_DIR)/requirements.txt
                    docker build -t indra docker
                        </pre>
                    </code>
                    </p>

                    <ul class="nested">
                        <li>
                            <a href="https://github.com/gcallah/indras_net/blob/master/docker/Dockerfile">
                                Here is a sample Dockerfile.
                            </a>
                        </li>

                        <li>
                            <a href="https://github.com/gcallah/indras_net/blob/master/docker/requirements.txt">
                                Here is the requirements file it uses.
                            </a>
                        </li>
                    </ul>


                </details>

                <details>
                    <summary class="sum1">
                        Other Readings
                    </summary>

                    <ul class="nested">
                       <li>
                            <a href="https://puppet.com/blog/containers-are-eating-world">
                                Containers are eating the world
                            </a>
                        </li>

                        <li>
                            <a href="https://www.ibm.com/developerworks/java/library/a-devops2/index.html">
                                Infrastructure automation
                            </a>
                        </li>

                        <li>
                            <a href="https://www.ibm.com/developerworks/library/d-bbd-guide-iac/">
                                A Behavior Driven Developer's guide to Infrastructure as Code
                            </a>
                        </li>

                    </ul>

                </details>


                {% include 'quiz.html' %}

            </div>
        </div>
    </div>


{% endblock content %}
